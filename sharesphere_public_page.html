<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel = "icon" href = "logo.jpg" type = "image/x-icon">
    <title>Share Sphere - Public Page</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: 'Poppins', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            background-attachment: fixed;
            text-align: center;
            min-height: 100vh;
            position: relative;
            color: #333;
        }

        body::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="20" cy="20" r="3" fill="rgba(255,255,255,0.1)"/><circle cx="80" cy="80" r="3" fill="rgba(255,255,255,0.1)"/><circle cx="50" cy="50" r="4" fill="rgba(255,255,255,0.05)"/><circle cx="10" cy="90" r="2" fill="rgba(255,255,255,0.08)"/><circle cx="90" cy="10" r="2" fill="rgba(255,255,255,0.08)"/></svg>') repeat;
            pointer-events: none;
            z-index: -1;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        #navbar {
            width: 100%;
            background-color: #001f3f;
            position: sticky;
            top: 0;
            left: 0;
            margin-bottom: 2px;
            z-index: 1000;
        }

        #nav-container {
            margin: 5px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        #name {
            display: flex;
            align-items: center;
        }

        #name span {
            font-size: 1.5rem;
            font-weight: bold;
            color: #edf6f9;
        }

        #desktop-nav {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 3.5rem;
            font-size: 0.8rem;
        }

        #desktop-nav a {
            color: #edf6f9;
            font-weight: 500;
            transition: color 0.5s ease;
            font-size: medium;
            text-decoration: none;
            font-size: 1.1rem;
        }

        #desktop-nav a:hover {
            color: #aff0e3;
        }

        #auth-buttons {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 0.5rem 1rem;
            border-radius: 20%;
            transition: all 0.2s ease;
            cursor: pointer;
        }

        #logout {
            background: #00b4d8;
            border: 2px solid #00b4d8;
            color: #edf6f9;
            font-size: 1rem;
            border-radius: 5px;
        }

        #logout:hover {
            background: #ff0000;
            color: #ffffff;
        }

        #addfiles {
            position: relative;
            background: linear-gradient(135deg, #ff6b6b, #ee5a24);
            border: none;
            color: #fff;
            font-size: 1.2rem;
            padding: 15px 30px;
            border-radius: 50px;
            transition: all 0.3s ease;
            font-weight: 600;
            margin: 20px;
            box-shadow: 0 8px 20px rgba(255,107,107,0.3);
            cursor: pointer;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        #addfiles:hover {
            background: linear-gradient(135deg, #ee5a24, #ff6b6b);
            transform: translateY(-3px);
            box-shadow: 0 12px 30px rgba(255,107,107,0.4);
        }

        #Pn {
            text-align: center;
            margin: 30px 0;
        }

        #hp {
            font-size: 3rem;
            font-weight: bold;
            color: white;
            margin: 50px 0 40px 0;
            text-align: center;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
            animation: glow 2s infinite alternate;
        }

        @keyframes glow {
            from { text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5); }
            to { text-shadow: 0 0 20px rgba(255, 154, 158, 0.8), 0 0 30px rgba(254, 207, 239, 0.6); }
        }

        #posts {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 1.5rem;
            justify-content: center;
            align-items: start;
            margin: 2rem auto;
            max-width: 1200px;
            padding: 0 1rem;
        }

        .post-card {
            background: linear-gradient(145deg, #ffffff, #f0f8ff);
            border: 2px solid #e0e0e0;
            border-radius: 25px;
            padding: 25px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1), 0 0 0 1px rgba(255,255,255,0.5);
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
            font-family: 'Poppins', sans-serif;
            position: relative;
            overflow: hidden;
        }

        .post-card:hover {
            transform: translateY(-15px) scale(1.03);
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.2), 0 0 0 1px rgba(255,255,255,0.8);
            border-color: #667eea;
        }

        .post-card img {
            width: 100%;
            height: 220px;
            object-fit: cover;
            background: linear-gradient(45deg, #f0f8ff, #e6f3ff);
            border-radius: 20px;
            margin-bottom: 20px;
            transition: all 0.4s ease;
            border: 3px solid #fff;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .post-card:hover img {
            transform: scale(1.08) rotate(1deg);
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
        }

        .post-card .username {
            font-weight: 700;
            color: #667eea;
            margin-bottom: 10px;
            text-align: center;
            font-size: 1.2rem;
            text-shadow: 0 1px 2px rgba(0,0,0,0.1);
        }

        .post-card .caption {
            color: #555;
            margin-bottom: 20px;
            text-align: center;
            font-style: italic;
            font-size: 1rem;
            line-height: 1.4;
        }

        .post-card .likes {
            color: #ff6b6b;
            font-size: 1.1rem;
            text-align: center;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            background: linear-gradient(135deg, #ffeaa7, #fab1a0);
            padding: 8px 15px;
            border-radius: 20px;
            margin: 0 auto;
            width: fit-content;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }

        .post-card .likes::before {
            content: 'ðŸ’–';
            font-size: 1.3rem;
        }

        #largepost {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(145deg, #ffffff, #f9f9f9);
            padding: 50px;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
            z-index: 9999;
            display: none;
            max-width: 95vw;
            max-height: 95vh;
            overflow: auto;
            border: 2px solid #e0e0e0;
        }
        #more
        {
            display: none;
            background-color: transparent;
            color: white;
            font-size: 1.8rem;
        }
        #loading
        {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(255, 255, 255);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
        }
        #helpbox
        {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: #ffffff;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            z-index: 10000;
            max-height: 80vh;
            overflow-y: auto;
        }
        #helpbut
        {
            position: fixed;
            top: 100px;
            right: 5px;
            background-color: #00b4d8;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            font-size: 0.7rem;
            cursor: pointer;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            z-index: 999;

        }
        #close
        {
            margin-top: 20px;
            font-size: 0.9rem;
            color: #555555;
            cursor: pointer;
        }
         @media (min-width: 851px) {
            #auth-buttons {
                flex-direction: row;
                gap: 1rem;
            }
            #desktop-nav
            {
                display: flex;
                flex-direction: row;
                gap: 3.5rem;
            }
            #more{
                display: none ;
                border: 2px solid #edf6f9;
                padding: 4px;
                margin: 2px;
            }
        }
        @media (max-width: 850px) {
            #desktop-nav {
                display: none;
            }
            #more {
                display: block;
            }
            #nav-container{
                flex-direction: column;
            }
            #auth-buttons{
                flex-direction: column;
                gap: 0.2rem;
            }
            #helpbut
            {
                top: 200px;
            }
        }
    </style>
</head>
<body>
    <nav id="navbar">
        <div id="nav-container">
            <div id="name">
                <span>Share Sphere</span>
            </div>
            <button id = "more">&#9776;</button>
            <div id="desktop-nav">
                <a href="sharesphere_your_account.html">Your Account</a>
                <a href="sharesphere_find_people.html">Find friends</a>
                <a href ="sharesphere_find_rooms.html">Join Room</a>
                <a href="sharesphere_about_us.html">About Us</a>
                <a href="sharesphere_feedback.html">Feedback</a>
            </div>

            <div id="auth-buttons">
                <button id="logout">Log Out</button>
            </div>
        </div>
    </nav>
    <main>
        <div id = "Pn">
            <button id = "addfiles">âœ¨ Add post</button>
        </div>
        <div id = "hp">Posts:-</div>
        <div id = "posts"></div>
        <footer style="text-align: center; padding: 20px; color: rgba(255,255,255,0.7); font-size: 0.9rem; margin-top: 50px;">
            Â© 2025 Share Sphere - Copyrights reserved 
        </footer>
    </main>
    <div id = "loading">
        <img src = "loading.gif">
    </div>
    <button id = "helpbut">Chat laguage help!</button>
    <div id="helpbox">
    <h2>Chat short forms</h2>

    <div class="item"><b>LOL:</b> Laugh Out Loud</div>
    <div class="item"><b>ROFL:</b> Rolling On the Floor Laughing</div>
    <div class="item"><b>BRB:</b> Be Right Back</div>
    <div class="item"><b>BTW:</b> By The Way</div>
    <div class="item"><b>OMG:</b> Oh My God</div>
    <div class="item"><b>IDK:</b> I Donâ€™t Know</div>
    <div class="item"><b>IKR:</b> I Know, Right?</div>
    <div class="item"><b>IMO:</b> In My Opinion</div>
    <div class="item"><b>TBH:</b> To Be Honest</div>
    <div class="item"><b>TTYL:</b> Talk To You Later</div>
    <div class="item"><b>DM:</b> Direct Message</div>
    <div class="item"><b>RN:</b> Right Now</div>
    <div class="item"><b>TMI:</b> Too Much Information</div>
    <div class="item"><b>SMH:</b> Shaking My Head</div>
    <div class="item"><b>FR:</b> For Real</div>
    <div class="item"><b>FOMO:</b> Fear Of Missing Out</div>
    <div class="item"><b>POV:</b> Point Of View</div>
    <div class="item"><b>FTW:</b> For The Win</div>
    <div class="item"><b>NGL:</b> Not Gonna Lie</div>
    <div class="item"><b>ICYMI:</b> In Case You Missed It</div>
    <div class="item"><b>GOAT:</b> Greatest Of All Time</div>
    <div class="item"><b>BFF:</b> Best Friends Forever</div>
    <div class="item"><b>SUS:</b> Suspicious / Suspect</div>
    <div class="item"><b>W / L:</b> Winning / Losing</div>
    <div class="item"><b>YEET:</b> Throw / Excitement</div>
    <div class="item"><b>CAP / NO CAP:</b> Lie / No Lie</div>
    <div class="item"><b>AF:</b> Slang (very)</div>
    <div class="item"><b>FYP:</b> For You Page</div>
    <div class="item"><b>WYD:</b> What You Doing?</div>
    <div class="item"><b>XOXO:</b> Hugs and Kisses</div>
    <div class="item"><b>GRWM:</b> Get Ready With Me</div>
    <div class="item"><b>OOTD:</b> Outfit Of The Day</div>

    <div id = "close">Click anywhere in the box to close</div>

</div>
    <div id = "largepost"></div>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script type="module">

        const { createClient } = supabase;
        const supabaseUrl = "https://vrwaodcjdaybfsphffgs.supabase.co";
        const supabaseKey = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZyd2FvZGNqZGF5YmZzcGhmZmdzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTg5Njk5MTcsImV4cCI6MjA3NDU0NTkxN30.yAKuQhYUeGEFeZpLZpTcgjlXUW4LYPIi2FbBr5SDXNM";
        const supabasec = createClient(supabaseUrl, supabaseKey);

        import { initializeApp } from "https://www.gstatic.com/firebasejs/12.3.0/firebase-app.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/12.3.0/firebase-analytics.js";

        const firebaseConfig = {
            apiKey: "AIzaSyBDXLWL-WySSNnRLL1khrnuWYnUE3-OF74",
            authDomain: "share-sphere-v-8.firebaseapp.com",
            databaseURL: "https://share-sphere-v-8-default-rtdb.firebaseio.com",
            projectId: "share-sphere-v-8",
            storageBucket: "share-sphere-v-8.firebasestorage.app",
            messagingSenderId: "931094139319",
            appId: "1:931094139319:web:4d202e258a5c4231ea9832",
            measurementId: "G-DKHQ2H23VM"
        };

        import { getFirestore, collection, getDocs, doc, getDoc, setDoc, updateDoc, query, orderBy } from "https://www.gstatic.com/firebasejs/12.3.0/firebase-firestore.js";
        import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/12.3.0/firebase-auth.js";

        const app = initializeApp(firebaseConfig);
        const analytics = getAnalytics(app);
        const db = getFirestore(app);
        const auth = getAuth();

        const loading = document.getElementById("loading");

        more.addEventListener("click", moreclicked);
        function moreclicked()
        {
            let dnav = document.getElementById("desktop-nav");
            dnav.style.display = "flex";
            dnav.style.flexDirection = "column";
            dnav.style.gap = "0"
            more.style.display = "none";
        }

        let logoutbtn = document.getElementById("logout");
        logoutbtn.addEventListener("click", fnclogout);

        function fnclogout()
        {
            signOut(auth)
            .then(() => {
                window.location.href = "sharesphere_logout.html"
            }).catch((error) => {
                alert("Error occured while signing out, please try again later.")
            });
        }

        let helpbut = document.getElementById("helpbut");
        let helpbox = document.getElementById("helpbox");
        helpbut.addEventListener("click", () =>
        {
            helpbox.style.display = "block";
        });
        helpbox.addEventListener("click", () =>
        {
            helpbox.style.display = "none";
        });

        let addbtn = document.getElementById("addfiles");
        addbtn.addEventListener("click", postimage);

        function postimage()
        {
            window.location.href = "sharesphere_upload_post.html";
        }
        const postsContainer = document.getElementById("posts");

        async function loadPosts() {
            postsContainer.innerHTML = "";

            const postsSnapshot = await getDocs (query(collection(db, "posts"), orderBy("timestamp", "desc")));
            const postsArray = postsSnapshot.docs;

            let i = 0;

            while (i < postsArray.length) {
                if (i>6)
            {
                loading.style.display = "none";
            }
                const postDoc = postsArray[i];
                const postData = postDoc.data();

                const email = postData.email;
                const imgSrc = postData.imageUrl;
                let caption = postData.caption;

                const userRef = doc(db, "users", email);
                const userSnap = await getDoc(userRef);

                let username = "Unknown User";
                if (userSnap.exists()) {
                username = userSnap.data().username || "Unknown User";
                }

                const postDiv = document.createElement("div");
                postDiv.className = "post-card";

                const img = document.createElement("img");
                img.src = imgSrc;
                img.alt = "Post Image";

                const userDiv = document.createElement("div");
                userDiv.className = "username";
                userDiv.textContent = username;

                const captionDiv = document.createElement("div");
                captionDiv.className = "caption";
                captionDiv.textContent = caption;

                const likes = document.createElement("div");
                likes.className = "likes";
                likes.textContent = `Likes: ${postData.likes || 0}`;

                postDiv.addEventListener("click", function (event) {
                    event.stopPropagation();
                    const largePost = document.getElementById("largepost");
                    largePost.innerHTML = "";
                    largePost.style.display = "flex";
                    largePost.style.flexDirection = "column";
                    largePost.style.alignItems = "center";
                    largePost.style.border = "1px solid #ccc";
                    largePost.style.padding = "20px";
                    largePost.style.backgroundColor = "#f9f9f9";
                    largePost.style.height = "auto";
                    largePost.style.width = "auto";

                    const largeuserDiv = document.createElement("div");
                    largeuserDiv.textContent = username;
                    largeuserDiv.style.marginBottom = "20px";
                    largeuserDiv.style.fontWeight = "bold";
                    largeuserDiv.style.fontFamily = "Arial, sans-serif";
                    largeuserDiv.style.textAlign = "center";
                    largePost.appendChild(largeuserDiv);
                    const largeImg = document.createElement("img");
                    largeImg.src = imgSrc;
                    largeImg.alt = "Large Post Image";
                    largeImg.style.maxWidth = "80vw";
                    largeImg.style.maxHeight = "80vh";
                    largeImg.style.borderRadius = "8px";

                    const largeCaption = document.createElement("div");
                    largeCaption.textContent = caption;
                    largeCaption.style.marginTop = "10px";
                    largeCaption.style.fontFamily = "Arial, sans-serif";
                    largeCaption.style.color = "#333";
                    largeCaption.style.fontSize = "1.2rem";

                    largePost.appendChild(largeImg);
                    largePost.appendChild(largeCaption);
                    largePost.style.display = "block";
                    let body = document.querySelector("body");
                    document.addEventListener("click", function(event)
                        {
                            if (!largePost.contains(event.target)) 
                            {
                                largePost.style.display = "none";
                            }

                        });
                    let closebtn = document.createElement("div");
                    closebtn.textContent = "Click anywhere to close";
                    closebtn.style.marginTop = "10px";
                    closebtn.style.fontFamily = "Arial, sans-serif";
                    closebtn.style.color = "#777";
                    closebtn.style.fontSize = "0.9rem";

                    const likebtn = document.createElement("button");
                    likebtn.innerHTML = "&#x1F44D;";
                    likebtn.style.marginTop = "15px";
                    likebtn.style.padding = "10px 20px";
                    likebtn.style.fontSize = "1rem";
                    likebtn.style.cursor = "pointer";
                    likebtn.addEventListener("click", async (e) => {
                        e.stopPropagation();
                        const postRef = doc(db, "posts", postDoc.id);
                        const postSnap = await getDoc(postRef);
                        if (postSnap.exists()) {
                            let currentLikes = postSnap.data().likes || 0;
                            currentLikes += 1;
                            await updateDoc(postRef, { likes: currentLikes });
                            likes.textContent = `Likes: ${currentLikes}`;
                            alert("You liked this post!");
                        }
                    });
                    largePost.appendChild(likebtn);
                    largePost.appendChild(closebtn);

                });

                postDiv.appendChild(img);
                postDiv.appendChild(captionDiv);
                postDiv.appendChild(userDiv);
                postDiv.appendChild(likes);
                postsContainer.appendChild(postDiv);

                i++;
            }
        }

        loadPosts();

        onAuthStateChanged(auth, (user) => {
                if (!user) {
                    alert("User is signed out, redirecting to homepage.");
                    window.location.href = "index.html";
                }
                else if (!user.emailVerified) {
                    alert("Please verify your email first to use our application, an link has been sent in your email, please clcik on that link to continue using our application. Please find the email in the spam folder.");
                    window.location.href = "index.html";
                }
            });

        
    </script>
    <script>
        testSpeed();
async function testSpeed() {
    const fileUrl = "https://speed.cloudflare.com/__down?bytes=1000000"; 
    const fileSize = 1 * 1024 * 1024; // 1MB in bytes

    const startTime = performance.now();

    try {
        const response = await fetch(fileUrl, { cache: "no-store" });
        await response.blob(); // Wait for file to fully download
    } catch (e) {
        alert("Connect to a better internet connection to continue using our application");
        window.location.href = "index.html";
    }

    const endTime = performance.now();
    const durationInSeconds = (endTime - startTime) / 1000;

    const speedBps = fileSize / durationInSeconds;        // bytes per second
    const speedMbps = (speedBps * 8) / (1024 * 1024);     // convert to Mbps

    if (speedMbps < 0.1)
    {
        alert("Connect to a better internet connection to continue using our application");
        window.location.href = "index.html";
    }
    else if (speedMbps < 0.5)
    {
        alert("Looks like you have a slow internet connection, some of the fetures might not work properly!");
    }
}
</script>
</body>
</html>
