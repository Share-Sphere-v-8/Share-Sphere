<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel = "icon" href = "logo.jpg" type = "image/x-icon">
  <title>Share Sphere</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #b3c3f3;
      margin: 0;
      padding: 0;
      text-align: center;
    }
        #navbar {
        width: 100%;
        background-color: #001f3f;
        position: sticky;
        top: 0;
        left: 0;
    }

    #nav-container {
        width: 100%;
        display: flex;
        justify-content: space-between;
        align-items: center;
    }

    #name {
        display: flex;
        align-items: center;
    }

    #name span {
        font-size: 1.5rem;
        font-weight: bold;
        color: #edf6f9;
    }

    #desktop-nav {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 3.5rem;
        font-size: 0.8rem;
    }

    #desktop-nav a {
        color: #edf6f9;
        font-weight: 500;
        transition: color 0.5s ease;
        font-size: medium;
        text-decoration: none;
        font-size: 1.1rem;
    }

    #desktop-nav a:hover {
        color: #ffddd2;
    }

    #auth-buttons {
        display: flex;
        align-items: center;
        gap: 1rem;
        padding: 0.5rem 1rem;
        border-radius: 20%;
        transition: all 0.2s ease;
        cursor: pointer;
    }

    #asi {
        background: transparent;
        border: 2px solid #83c5be;
        color: #edf6f9;
        font-size: 1rem;
        border-radius: 5px;
    }

    #asi:hover {
        background: #83c5be;
        color: #006d77;
    }

    #asu {
        background: #e29578;
        border: 2px solid #e29578;
        color: #edf6f9;
        font-size: 1rem;
        border-radius: 5px;
    }

    #asu:hover {
        background: #ffddd2;
        color: #006d77;
    }

    #logout {
        background: #00b4d8;
        border: 2px solid #00b4d8;
        color: #edf6f9;
        font-size: 1rem;
        border-radius: 5px;
    }

    #logout:hover {
        background: #ffddd2;
        color: #006d77;
    }
    #more
    {
        display: none;
        background-color: transparent;
        font-size: 1.8rem;
        color: white;
    }
    #container {
      text-align: center;
      background: #98c1d9;
      width: 90%;
      max-width: 800px;
      padding: 40px;
      border-radius: 15px;
      box-shadow: 0 6px 14px rgba(0,0,0,0.15);
      margin: auto;
      margin-top: 50px;
      box-sizing: border-box;

    }
    h1 {
      color: #2c3e50;
      font-size: 42px;
      margin-bottom: 20px;
    }
    p {
      color: #555;
      font-size: 20px;
      line-height: 1.6;
    }

    
    #profile {
      display: flex;
      align-items: center;
      justify-content: center;
      margin-top: 30px;
      gap: 15px;
    }
    #profile img {
      width: 4rem;
      height: 4rem;
      border-radius: 50%;
      object-fit: cover;
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }
    #profile-name {
      font-size: 28px;
      font-weight: bold;
      color: #2c3e50;
    }

    
    .launch-btn {
      display: inline-block;
      background: #d6ccc2;
      padding: 15px 30px;
      margin-top: 40px;
      border-radius: 12px;
      box-shadow: 0 6px 14px rgba(0,0,0,0.15);
      font-size: 22px;
      font-weight: bold;
      color: #3d3d3d;
      text-decoration: none;
      transition: background 0.3s ease, transform 0.2s ease;
      border: none;
    }
    .launch-btn:hover {
      background: #cdb4db;
      transform: scale(1.05);
    }
    @media (min-width: 751px) {
      #auth-buttons {
          flex-direction: row;
          gap: 1rem;
      }
      #desktop-nav
      {
          display: flex;
          flex-direction: row;
          gap: 3.5rem;
      }
      #more{
          display: none ;
          border: 2px solid #edf6f9;
          padding: 4px;
          margin: 2px;
      }
    }
    @media (max-width: 750px) {
      #desktop-nav {
          display: none;
      }
      #more {
          display: block;
      }
      #nav-container{
          flex-direction: column;
      }
      #auth-buttons{
          flex-direction: column;
          gap: 0.2rem;
      }
    }
  </style>
</head>
<body>
  <nav id="navbar">
      <div id="nav-container">
          <div id="name">
              <span>Share Sphere</span>
          </div>
          <button id = "more">&#9776;</button>
          <div id="desktop-nav">
              <a href="sharesphere_your_account.html">Your account</a>
              <a href="sharesphere_public_page.html">Public page</a>
              <a href = "sharesphere_about_us.html">About Us</a>
              <a href="sharesphere_feedback.html">Feedback</a>
          </div>

          <div id="auth-buttons">
              <button id="asi">Sign In</button>
              <button id="asu">Sign Up</button>
              <button id="logout">Log out</button>
          </div>
          
      </div>
  </nav>
  <div id="container">
    <h1>Welcome to Share Sphere!</h1>
    
    <div id="profile">
      <img src="#" alt="Profile Picture" id = "pfp">
      <div id="profile-name">User id of the person</div>
    </div>
    <p>
      <b>This is a platform where you can share your thoughts and ideas with the world.
      You can also find people with similar interests and connect with them. Explore the
      public posts and feel free to join the conversation with your friends!</b>
    </p>
    <a href="sharesphere_public_page.html" class="launch-btn" id="launch-btn">Launch Application</a>
    <button class="launch-btn" id="signin-btn">Sign In</button>
    <button class="launch-btn" id="signup-btn">Sign Up</button>
  </div>
  <script type = "module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-app.js";
      import { getAnalytics } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-analytics.js";
      import { getFirestore, doc, setDoc, addDoc, getDoc } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-firestore.js";
      import {
          getAuth,
          signInWithEmailAndPassword,
          createUserWithEmailAndPassword,
          onAuthStateChanged,
          signOut,
          sendEmailVerification
          } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-auth.js";
      const firebaseConfig = {
          apiKey: "AIzaSyBDXLWL-WySSNnRLL1khrnuWYnUE3-OF74",
          authDomain: "share-sphere-v-8.firebaseapp.com",
          databaseURL: "https://share-sphere-v-8-default-rtdb.firebaseio.com",
          projectId: "share-sphere-v-8",
          storageBucket: "share-sphere-v-8.firebasestorage.app",
          messagingSenderId: "931094139319",
          appId: "1:931094139319:web:4d202e258a5c4231ea9832",
          measurementId: "G-DKHQ2H23VM"
      };
      const app = initializeApp(firebaseConfig);
      const analytics = getAnalytics(app);
      let auth = getAuth();

      onAuthStateChanged(auth, (user) =>
        {
            if (user)
            {
                asu.style.display = "none";
                asi.style.display = "none";
                logout.style.display = "block";
                document.getElementById("launch-btn").style.display = "inline-block";
                document.getElementById("signin-btn").style.display = "none";
                document.getElementById("signup-btn").style.display = "none";
            }
            else{
                asu.style.display = "block";
                asi.style.display = "block";
                logout.style.display = "none";
                document.getElementById("launch-btn").style.display = "none";
                document.getElementById("signin-btn").style.display = "inline-block";
                document.getElementById("signup-btn").style.display = "inline-block";
            }
        });

      asi.addEventListener("click", () =>
      {
          window.location.href = "sharesphere_sign_in.html";
      });
      asu.addEventListener("click", () =>
      {
          window.location.href = "sharesphere_sign_up.html";
      });
      document.getElementById("signin-btn").addEventListener("click", () =>
      {
          window.location.href = "sharesphere_sign_in.html";
      });
      document.getElementById("signup-btn").addEventListener("click", () =>
      {
          window.location.href = "sharesphere_sign_up.html";
      });
      logout.addEventListener("click", fnclogout);
      function fnclogout()
      {
          signOut(auth)
          .then(() => {
              window.location.href = "sharesphere_logout.html"
          })
          .catch((error) => {
              alert("Error occured while logging out");
          });
      }

    let more = document.getElementById("more");
    more.addEventListener("click", moreclicked);
    function moreclicked()
    {
        let dnav = document.getElementById("desktop-nav");
        dnav.style.display = "flex";
        dnav.style.flexDirection = "column";
        dnav.style.gap = "0"
        more.style.display = "none";
    }

      async function fetchUserData() {
          let pfp = document.getElementById("pfp");
          let profileName = document.getElementById("profile-name");
          let auth =  await getAuth();
          let user = auth.currentUser;
          if (user) {
            if (!user.emailVerified) {
                profileName.textContent = "Please verify your email";
                pfp.style.display = "none";
                return;
            }
              let email = user.email;
              profileName.textContent = user.email; 
              let username_pfp = await getDoc(doc(getFirestore(), "users", email));
              let pfpUrl = username_pfp.data().pfpUrl;
              let username = username_pfp.data().username;
              if (pfpUrl) {
                  pfp.src = pfpUrl;
              } else {
                  pfp.src = "https://thumbs.dreamstime.com/b/default-avatar-profile-icon-social-media-user-image-gray-blank-silhouette-vector-illustration-305503988.jpg";
              }
              if (username) {
                  profileName.textContent = username;
              } else {
                  profileName.textContent = email;
              }
          } else {
              pfp.style.display = "none";
              profileName.style.display = "none";
          }
      }
      
    onAuthStateChanged(auth, (user) => {
        fetchUserData(user);
    });
      
  </script>
</body>
</html>

